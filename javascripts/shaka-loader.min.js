var playlist={streams:[],titles:[],pos:-1};function init(passIf){(playlist.streams.length>0||!0===passIf)&&(-1!=playlist.streams[0].indexOf("m3u8")?(console.log("hls"),hlsLoad()):(console.log("dash"),initApp()))}function initApp(){if(shaka.polyfill.installAll(),shaka.Player.isBrowserSupported()){var player=initPlayer();window.player=player,doPlay(player,pushNext())}else console.error("Browser not supported!")}function initPlayer(){var video=document.getElementById("video_player_id"),player=new shaka.Player(video);return player.addEventListener("error",onErrorEvent),video.addEventListener("ended",(function(){player.unload(),doPlay(player,pushNext())})),player}function doPlay(player,src){player.load(src.manifest).then((function(){console.log("hello")})).catch(onError)}function pushNext(){return playlist.pos++,playlist.pos>playlist.streams.length-1&&(playlist.pos=0),{manifest:playlist.streams[playlist.pos],title:playlist.titles[playlist.pos]}}function onErrorEvent(event){onError(event.detail)}function onError(error){console.error("Error code",error.code,"object",error)}function onHlsError(hls,event,data){switch(mediaController.setLoader(!0),data.type){case Hls.ErrorTypes.NETWORK_ERROR:console.log("fatal network error encountered, try to recover"),hls.startLoad();break;case Hls.ErrorTypes.MEDIA_ERROR:console.log("fatal media error encountered, try to recover"),hls.recoverMediaError();break;default:console.log("couldn't recovered"),hls.destroy(),mediaController.forceRetry()}}function setupEvents(HLSPlayer){null!==HLSPlayer&&(console.log("setting up"),HLSPlayer.on(window.Hls.Events.LEVEL_LOADING||window.Hls.Events.FRAG_LOAD_PROGRESS,()=>{mediaController.setLoader(!0)}),HLSPlayer.on(window.Hls.Events.FRAG_BUFFERED||window.Hls.Events.FRAG_LOADED,()=>{mediaController.setLoader(!1)}))}function configPlayer(){window.Hls.DefaultConfig={...window.Hls.DefaultConfig,autoStartLoad:!0,startPosition:-1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,liveSyncDuration:10,manifestLoadingMaxRetry:10,levelLoadingMaxRetry:40,fragLoadingMaxRetry:60,startFragPrefetch:!0}}function hlsLoad(stream){if(Hls.isSupported()){var video=document.getElementById("video_player_id");configPlayer();var hls=new Hls;hls.loadSource(playlist.streams[0]),hls.attachMedia(video),hls.on(Hls.Events.MANIFEST_PARSED,(function(){console.log("MANIFEST_PARSED")})),hls.on(Hls.Events.ERROR,(event,data)=>onHlsError(hls,event,data)),setupEvents(hls),window.HlsPlayer=hls}else initApp()}